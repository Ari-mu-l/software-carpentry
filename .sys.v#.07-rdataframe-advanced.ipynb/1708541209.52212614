{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "60ae38e3",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "# RDataFrame advanced features\n",
    "There are many more features available with the RDataFrame that might serve your analysis needs!"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2e8e9ace",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "## Working with `numpy` arrays\n",
    "- RDataFrame offers interoperability with `numpy` arrays. \n",
    "\n",
    "- It can be created from a dictionary of such arrays and it can also export its contents to the same format. \n",
    "\n",
    "- All operations are available also when using the `numpy`-based dataset.\n",
    "\n",
    "- **Note:** this support is limited to one-dimensional numpy arrays, which are directly mapped to columns in the RDataFrame."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "128e586a",
   "metadata": {
    "slideshow": {
     "slide_type": "subslide"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columns in the RDataFrame: { \"a\", \"b\", \"c\" }\n"
     ]
    }
   ],
   "source": [
    "import numpy\n",
    "import ROOT\n",
    "\n",
    "np_dict = {colname: numpy.random.rand(100) for colname in [\"a\",\"b\",\"c\"]}\n",
    "\n",
    "df = ROOT.RDF.FromNumpy(np_dict)\n",
    "\n",
    "print(f\"Columns in the RDataFrame: {df.GetColumnNames()}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "dde693ee",
   "metadata": {
    "collapsed": true,
    "slideshow": {
     "slide_type": "subslide"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of rows in the dataset: 100\n",
      "Average value of column a: 0.49883769291632474\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAArgAAAHYCAIAAAApvgy/AAAABmJLR0QAAAAAAAD5Q7t/AAAcwklEQVR4nO3dbZaqOrguULjj9ovQmX2bATTj7s6ALfP8yKkMNhiKUpQP5/yxRpWiAuUyj0l4U97v9wIA4JH/s/cOAADHJSgAAFmCAgCQJSgAAFmCAgCQJSgAAFmCAgCQJSgAD7Rt27bt3nsB7K9UcAmYCyHcbjefD4AeBQAgS1AAALIEBaAoiqJt2xBCCMHUBGDMHAWgKMvy4e0+HwA9CvDtQghFUVRVdf+x9x4BB6JHAb5d7E4YfxQMw1DXdaFHAdCjAF9uGIaiKJqmGd8Y+xgACkEBvlwMCvNkUFXV53cGOCBBAb5ajAgxLozdbrfP7wxwQIIC8CAoAESCAny12KMw6T9QSgFIBAX4dnEmY1mWwzAMw9C2bdd1e+8UcBQujwSKSTiI0aHrOp8PgKAA/K/Uo7D3jgAHIigAAFnmKAAAWYICAJAlKAAAWYICAJAlKAAAWf937x0A4Gri2uUc3MrLHgUFALbn2vuDWx/mDD0AAFmCAgCQJSgAwCrDMMQFV7+KoAAAa03WZP8GggIAkOWqBwDIiquqFkXxhYMOkaAAAI+1bdt1XVEUVVV1XVdV1d57tAPLTAOwsbK8SONSlmVVVbFHofipPXCZQ1t5IOYoAMADbdsWRZFSQlEU39mjICgAwCrfOU1BUAAAsgQFAHgg9h+Mhx7GP3+Pi8w3AeA4rjSZsfiZvTgMQ13XhcmMAEDU931RFGVZlmVZ13XTNHvv0Q4uEvoAOI7L9ChElyy4tP5v9Orf8uEKGTsum7F+gW0A3udKQeGSPhcUyrLs+34SCx7e+BkXi7EAZ+Sj+Pg+ERSWv7vv9Rbx7gTYnc7dU1jZXD6/1kN8gR07DwA4LN/ZDm59mHt1UShvBQC4sA1Wj0xLcI7FEtkAwKm9GhRCCLfbrfjWpTIAWG8YhodfI0MIr3y9jI/1BfVNXg0Kt9utaRp/HgB+NQzD7XZ77otlDBMPp8TFp/2SlihXRjqEsHDXK6+4weWRh5qmcLT9AfhCuY/itm27rnvuU9rc+Sg3CfF+vz+8q6qqhwHicyWcq6o6WogrM/beLwB+ERuUOEIxblzS4EJs89Jmad2mSVsY+x7mzVO6/bzLO91nip9S0w/v2qCNnj/vn8Sdq6qq+a8Xn/Zprx8RAC/KfRTHtRJyj4oNStwmDU/Eu9KvsX1Jm8UNxk8bn2T+DPefb8+Tpzq7qqqqqsrdtXCM65vLV5vV3FDTi0/7NEEBYHfLQaGa6fv+PvrmOX6e1NTF783p5/FLjIPC/Bnir/HJ0zMstK8nkutIuP+Wye5/aS5fHXoYhiG3BwDwVyu7yh8u5BgHFMbDCk3TxEvzxhsUmQv7T2dhQcuu61Lnyos2qKOwo4VJngAc0/Ln9uvTFR9OSgshVFXVdV3XdVVVvXhB5hEsXBQab9xq4uerQWFh+uWLz/yrWMJhx5UqAdjLwid/7pt0mgg5DENMDKfu/+66bqE7IXfXE14depiPl8TZE5vs3IJ41ey7XwWAMwo/itF4xPjSiRgmztsnPb76Y/1dz9l46CGOBZRl+e4unTgw03XdW18FgM09bJ7X9A3/2oUcxxfquo5dBcMw1HUdJ93HXoRJejhvh/RCI9u27ba1kt81R+GtIwIhhFgOUlAAOJ26ruc3rhkF6Lru10mI8ctqGhZP5YZiR8L4pT/Q+f0+sSzyX+96zvZB4d19CW3bxqkJuQ2eqK106mGqb1OW/45/vd//OfsL7eLaR8dhTcooTYQQJp/G41/v93v65J9sNnna8Zbjr6zjkHHevoRisTvkHT0lG5Rwnt+YKxj5upgH0z7PK3oq4Xx5ZflvatXGP5/3hXZx7aNjdz6Kj2/93+jVHoUPvxXml3zE8afzTkgBgCPbcujhA1cqTgp0x1XIzn4tLAAc1gZBYTKp8K3f79OE1ajrutyqowDA616toxBTQqrF3ff97XazVCMAXMOrQSFWk06d/2nO6mcmDdzvd90JAGcR+4BzdRR8nh/TBkMP/rQArBHHqSezzYqvLLa7clbf/HLH3PfwtM3ml4BuM0dhPJ3w7OWuAHireSb4wjnpsb7wclWJ8YlKtQAelqtqmibeOxn6n1QQeM6rQw9938eimDEuhBAWVr38jDJjx10CIEoFlcc3xkvYJlvG1Rkedj/E5mZyV6qnlO59w+5vYE1fQiwt2Pd9nP8X61LHu+ZLLBX/rR2QHlVkUsWf3V8WF4KKz1ZVVdrFXWxyRBxZUfz/hz+f94V2ce2jY3e5j+LYTETpxtjUxX/TjbFZSY3LeMp8am7iD+PWND0q/fCWw3vB+It0Oqi5ySm63+/jI53cnp5n8pzpxD58ifXN5dWaVUHh8gSFTVz76NjdclCYZ4LJjbE1TRuMf520oONfYzgY54YjtwjLQaFpmkkD/3D7+dkYP+pAQWHh7/R5R35bsAlBYRPXPjp2txwU7v/9fhx/HgeFeWdArlkdbzlpNSdp42iWg8JELvQsN7jL4wbrT86rcxTibIs0FBRXt9xmUASAi0pFdXPz32NJnoeTzOIUhC+ZfBYXw4zzFSZ3xTW1c0tDxZOT4sIrXr3qIe592tF4gWxZlh8o5wzASbVtG79Sxq+X8w3m5fljmxK/ncbrBS5feiEebK7e8cP08OujnrD9MtMAsCw28Glu/8I2UarWP/l2emGxSyB3sPMlEseP2qQjIXl16GEe+nJ7DwBJVVWx/tK8vYirAYwLB41XFEq3X7hMUzwn93z14bh4wuTGsizTFJANvdqjEAcaYoSpqir+zXLxEACiOPrwcNwhhNA0zXi6W2pWmqbpui7mhqqq4q+Tun8nFctCxBj0cG3k9OtyYcPco55WbhI90rEVexfYWpjbsnnIYhdl+e/9/s/85/O+0C6ufXTsriw3a1yKWYs4KVF80nLAZVlOKjPGuQXxvD1sy9IwRFyOcXKGh2F4eCVBbvBi/d9om7/lcWz17uSwBIVNXPvo2J2P4uNb/zd6dY4CAHBhggIAkCUoAABZggIAkCUoAABZKjMC8FGxYEAsFRBCWH9RfVwl4OHtk18PUt35T5duPlz6YPkC0eThBpudgZWLR53F9Y6ICatHbuLaR8fuFj6KY9PTNE3TNLHa0sJCyWOTxannz1n9SC/xyiG8aFJ4cOX2432ePMP4tMyrVKV7J+Ual9eWXHksV2tWvycSfS1BYRPXPjp2l/vInS+XHJvD8ZLTuQZ+OShMHhXby4Vm8t3GAaiYrZr9cPvJUYwfNVkyO3eWJmkjtzh1epLfDuJ/XXCOwvKfAYC9xOGG8S1xreT4c1p4ety1Hssz/3UhxPhUk0qFcWWp8UjH5LUe3vKE8Qraxc/SFQvbj0/Cw2eIv07KOM6fJ24/qfT8+uFcMCgAcExxSaDJpIQ0Np+WOUjNZFmWXdfF4sR/XR9g0gkfn6ooiq7ryrJMjegkTNR1/XrLOgzDuOFPdZdzG49XwEo3TjabLxs9j1Dj01hsOFNhZc/DWVzviJgw9LCJax8du1v4KB63fPP+82LUc178t8d+oc0qHnXFj4cq4tyFdFf6dTLwMenhf9rk5XJ7mO6KOzDeZr4n6fDnyy6OXys+MM3VWJiosf5I9SgA8DmxqYtdC/HL/Zpe9GLWQ7DSpJciats2jgVMvutPegKetn7x67gw9PwMxF2KV3k8vBpiHG7mnTTbcnkkAB81vsoxLpk4v+5x3m0eQohjByulZ4g/zFdWjA1wXKg63nK73ebf199nMhFhou/7uq7jbo9DUgjhPuqYiStJplw1XlUyDay8GCP0KADwIQ8DQexdmG/54mtNXqhpmv6/xt0JwzCkL/Evvm5RFCu7JeIelj+Kn/kT8d4YCKLYBZLbt3QCu66bz40wmRGA05jP2ls23vivD7zdbvGLeGwvw8j82eJ38edGN+ZiN8l4Z4pHX+vbth0Hl6IoYhmJIlN8KSWbyV3pWpJNxk0eWDmX4Syud0RMmMy4iWsfHbvLfRTPZ9jFtnk8gXH8c3qeNCKQe7nYxPZ9n6vjVPyM66cmebIP2zYfRX5WZq6oVJGvozCuiDA5Y+OKEZPqEcvFJNYf79Wa1e+JRF9LUNjEtY+O3S185M6/9Y5bx0kbP9lsISgsPOfD150/w681kf5koTLjw92b375QY3Fy1/wELpyH8cutPJbyfq1KRGV5tSNioiz/vd//mf983hfaxbWPjt39+lE8nsz48K50+4bLFiy86Ju8vvMLz/DcXcn65vJqzaqgcHmCwiaufXTszkfx8a3/G5nMCABkHauOwvBjPqszmS8n+tZCEwDwzQ7Uo9C2bSqyXdd1Liisr3gFwF5Kjm39n/JAPQpd16UKGPOFOsZeLx8BwPt88wSF8nLzM47SozCZopmrJyUiAMAnHSUojItXp4pUC5fNxJ4TsxMA4K0ONPQQpcqXCytzxAmMwzDElTAm3Qx/GnqJLtZNBABbOVxQSBc+1HWdpiwkbdumXoR413wxMa0+AGzlKEMPY+mKx19nJGy1NBYA8NBRgkLbtmuGDOKIw+TGjxXjBIBvc6CgUIxW4ZxcBJHyweSyybqu37WqJgBwnKBQFEXTNF3XxcsZ6rpumiaNLKSJCMMwVFWV6kVUVWXcAQDe50CTGeNExfmaV+MrJ4ufzoYN1xMDAHIOFBSilW2/iAAAH3CgoQcA4GgO16PwutzVE+orAMBfXTAoCAQAsBVDDwBAlqAAAGQJCgBAlqAAAGQJCgBAlqAAAGQJCgBA1gXrKCi4BABbuWBQEAgAYCuGHgCALEEBAMgSFACALEEBAMgSFACALEEBAMgSFACArAvWUVBwCQC2csGgIBAAwFYMPQAAWYICAJAlKAAAWYICAJAlKAAAWYICAJAlKAAAWReso6DgEgBs5YJBQSAAgK0YegAAsgQFACDrlEFhGIa2bUMIwzDsvS8AcGXnCwpt29Z1HSNCXdchhJ13CACu63yTGbuu6/s+5oNhGOq63nuPAOCyTtajEDsSUi9Cigt77Q8AXNvJgkIIIV39OAxDDApGHwDgTc439BCFEG63W1EUfd9P7soVXFqg9AKXV5b/7r0LbzQ/uvv9n132BK7nrEFh+FHXdZqyEGn14aFrt53jo7t2KoIPO9nQw1gIoW3bwhwFAHibkwWFtm2fGFkAAJ5zvqCQ/i1mF0EAANs6WVAoiqJpmq7ryrIsy7Ku66ZpBAUAeJPzTWZs27ZtW30JAPAB5wsKkYgAAB9wvqEHAOBjztqjsCB3WYT6CgDwVxcMCgIBAGzF0AMAkCUoAABZggIAkCUoAABZggIAkCUoAABZggIAkHXBOgoKLgHAVi4YFAQCANiKoQcAIEtQAACyBAUAIEtQAACyBAUAIEtQAACyBAUAIOuCdRQUXAKArVwwKAgEALAVQw8AQJagAABkCQoAQJagAABkCQoAQJagAABkCQoAQNYF6ygouAQAW7lgUBAIAGArhh4AgCxBAQDIOtbQw/AjhNC27cNtQgiTX3NbAgAvOlCPQtu2dV0Pw1AURdd1uTmJt9vto7sFAF/sQD0KXdc1TZO6B8qybNv2YW9BDBMAwLsdqEeh+O+wQlVV80AgIgDAJx0oKNzv93FQuN1uk+kIxU9QCCGUZRm7HD62ewDwhQ4UFJJhGOIEhYX5jH3fN03Tdd08TJR/9+YDAoCzOtAchSiEcLvdHo47FEUxnrUQI0LXdZNtFFwCgK0cq0ehLMvb7db3/cq5CDErmLgAAG9yoKBQlmVVVZOZChNt285jwcL2AMArjjL0kGYpTnJADAFt24YQ4r1d16XBhbquq6r68K4CwPc4VlDoum485yDOVIjhII0yxEsexht8fm8B4EscJSjkaisVRRFCGM9PjMkg9UC8f9cA4HsdJSj8lYgAAB9woMmMAMDRnLVHYUGugJL6CgDwVxcMCgIBAGzF0AMAkCUoAABZggIAkCUoAABZggIAkCUoAABZggIAkHXBOgoKLgHAVi4YFAQCANiKoQcAIEtQAACyBAUAIEtQAACyBAUAIEtQAACyBAUAIOuCdRQUXAKArVwwKAgEALAVQw8AQJagAABkCQoAQJagAABkCQoAQJagAABkCQoAQNYF6ygouAQAW7lgUBAIAGArhh4AgKxTBoVhGNq2DSG0bbv3vgDAlZ0vKLRtW9f1MAxFUXRdl5uRAAC87nxBoeu6pmmGYRiGIU5H0K8AAG9yvqBQFEUIIf1cVVXsXQAANne+qx4mFzXcbremafbaGQC4tvMFhWQYhrqui9nQwxOzFna5orIs//3vPvzz+X14wsrdnmy25iEf89yZX/Oo+VGnzRYefrRzdah35sLJKRb3bfzAJw7hUCfhYxbewHyzswaFEMLtdns47nCiOgq5VuTgVu72yqZ0F38985NjWdm05xqblR/HO56rQ70zXwyjTx/CoU7Cx2xy6riYUwaF2GfQ9/14sgIAsLnzBYWyLE1gBIDPOFlQiPkghDAJCroWAOAdThkUuq7rui7dqIMBAN7kZHUU2ra9z0gJAPAmJwsKAMAnCQoAQNbJ5iiskSu4dKL6CgBwEBcMCgIBAGzF0AMAkCUoAABZggIAkCUoAABZggIAkCUoAABZggIAkHXBOgoKLgHAVi4YFAQCANiKoQcAIEtQAACyBAUAIEtQAACyBAUAIEtQAACyBAUAIOuCdRQUXAKArVwwKAgEALAVQw8AQJagAABkCQoAQJagAABkCQoAQJagAABkCQoAQNYF6ygouAQAW7lgUBAIAGArhh4AgCxBAQDIOuLQQ9u2bdvm7g0hTH5d2BgAeMXhehSGYei6bhiG3Aa32+2DuwMAX+1APQrDMLRtuyYHLMQIAGBDx+pRCCE0TbOwgYgAAJ90oKAQZxssTziIQSGEUJZlWZZmJwDAWx0oKKwXQuj7vmmarusmcxuLoij/bo+DAIATONAchTXGXQ4xInRdN9lGwSUA2MopexSSmBVMXACANzlZUGjbdh4L5qMPAMAmzhEUUj4YhqGu63R7XddVVe22WwBwdScICrEEU/q5qqo0CbGqKuMOAPA+R5zMOJmNGEIY35K6FgqDDgDwZkcMCmuICADwAScYegAA9nLWHoUFuQJK6isAwF9dMCgIBACwFUMPAECWoAAAZAkKAECWoAAAZAkKAECWoAAAZAkKAEDWBesoKLgEAFu5YFAQCABgK4YeAIAsQQEAyBIUAIAsQQEAyBIUAIAsQQEAyBIUAICsC9ZRUHAJALZywaAgEADAVgw9AABZggIAkCUoAABZggIAkCUoAABZggIAkCUoAABZF6yjoOASAGzlgkFBIACArRh6AACyBAUAIOv0QaFt2713AQAu69xBYRiGruuGYdh7RwDgms4aFIZhCCHUdb33jgDAlZ01KBRFEUJommbvvQCAKzvr5ZEhhBBCURRd1+29LwBwWWcNCgtyBZcWPFF6oSz//e8z/PPXZziLyZFu/oTp1G3+Qivt8qdcebDPnasnDmHN/sy3ye3Pmh1Y/2yvW3jClS86vnd8dOt39eE5WTgJy5v9+hCi7/mgfqsLBoWPFVzavYX7mA3/d02eavf/xsv785kXXbnZynP1xCGsP+0LbeQT/x3WPNvrFp5q5YsuJ4PnUtHKJ//1VS7/4fO67/mgfp8Tz1EAAN5NUAAAsgQFACBLUAAAsk4/mdFakQDwPnoUAIAsQQEAyDr90MNcruCSQQoA+KsLBgWBAAC2YugBAMgSFACALEEBAMgSFACALEEBAMgSFACALEEBAMi6YB0FBZcAYCsXDAoCAQBsxdADAJAlKAAAWYICAJAlKAAAWYICAJAlKAAAWYICAJB1wToKCi4BwFYuGBQEAgDYiqEHACBLUAAAsgQFACBLUAAAsgQFACBLUAAAsgQFACDrgnUUFFwCgK1cMCgIBACwFUMPAECWoAAAZB1u6KFt26IoQgghhIcbTG4PIcSHAACbO1CPwjAMZVkOwzAMQ13Xueb/drt9dr8A4HsdqEehbduqqoZhiD93XZfLCnEbAODdDtSjcLvdUjKIP8wDgYgAAJ90lKAQE8Bk/kEuKIQQyrIsy9LsBAB4q6MEhYdy/QchhL7vm6bpum4+57H8u3cfCACc1IHmKMzNQ0DbtqkXId7bdd1kGwWXAGArh+5R+FXMCiYuAMCbHCUoPGzyH/YozGNBruICAPCiowSFoiiqqqrrOv6cyi6lX2M+iCUW0kPquq6q6rO7CQBf5EBzFGLBpTS1sO/7dHuatDgMQ7zkId6V6i4AAO9woKBQFMX9fp9fJxlCGM9PTF0LhUEHAHizYwWFYnXbLyIAwAccaI4CAHA0h+tReF2ugJL6CgDwVxcMCgIBAGzF0AMAkCUoAABZggIAkCUoAABZggIAkCUoAABZggIAkHXBOgoKLgHAVi4YFAQCANiKoQcAIEtQAACyBAUAIEtQAACyBAUAIEtQAACyBAUAIOuCdRQUXAKArVwwKAgEALAVQw8AQJagAABkCQoAQJagAABkCQoAQJag8NVyl5KS44z9idP1R/9v7x04E++ujxEUAICsC9ZRUHAJALZywaAgEADAVgw9AABZggIAkHXWoNC2bdu2wzBs+JwvzqF97eHPz3bedervPru912NfdNJD3uuMnfSQz3i6Xnz4GU/Xiy/9bRdcnC8oDMNQluUwDMMw1HXdtu3eewQAl3W+oNC2bVVVMSg0TdN13d57BACXdb6gcLvdUi9C/GHbAQgAIDlZUIiZIIQwvxEA2Fx5rqoDcV7CeJ/LsowjEenXffYMAIqiuFw5nysUXBp3MFzszwMA+zrZ0AMA8EknCwqx82AyKWEyZQEA2MrJgkJRFFVV1XUdf45XPQgKAPAmJ5vMGI1nLPZ9n4JCyg2iw8SvZ2ZyewhBJaucWBV07704nOXT4g22bPjhzEysOTPeXe92vh6Foiju93vf933f3+/3NBihXONDK8/M7Xb77H6d1TAMXde5Infi19PiDbagbdu6ruPZ67rOpVvJyjPj3fV290uoqqqqqvhz0zSXOa7XrTwzztiv+r6vqir+r4khlfvq0+INtqAoiqZpcr9+s5Vnxrvr3U7ZozCnXGPOmjPjXK0UQohhi7FfT4s32K/GnefjwjD8emacqw+4QlBQrjFn5ZlJm5VlWZalgZuH4sCnkzOx5rR4gy27/wyhRrfbzSyraM2Z8e76gCsEhYcEhZzcmQkh9H0f19nyOcXmvMF+FWcUFT+dfyS/nhnvrvfae+xjA33fTw6kMMh3v9+fPTMmeSwrzFF4ZP1p8QZ7KE71SDOKSP50Zry73uGyPQo87WFVK9iKN9hcWZa3263ve6dl4q9nxrvrHa4QFJRrzFl5Ztq2nf+/cgLZijfYsriy3f2/4/EU686Md9cHXGFRqOKnXOP9fi+Ua/yvhTPTtm0swRQvgr//lN6q6zpd8AZP8wZbI83F81VnYvnMeHd91G6DHlsbH5Qh5LGHZyZOX0i/jv9rGSVd5g320OS0eIOt9PDKUqfovnhmvLs+7JQlnHMeXg1IsfrMOIG8lTcY7+Pd9T6XCgoAwLauMJkRAHgTQQEAyBIUAIAsQQEAyBIUAGADcY20vfdie4ICAGzgdrvtvQtvISgAAFkXKeEMAJ8X178uiuJhKclrEBQA4BkxJcSS0nVd77077yIoAMCfxaLRqbrx/X5PvQsXY44CAPzZfHnrqxIUAIAsQQEAyBIUAODPYm2ltLD1hVe4FhQA4Bl9399ut7Is4zTGqqr23qO3KNOMTQDgr+Ksxgv3KAgKAECWoQcAIEtQAACyBAUAIEtQAACyBAUAIEtQAACyBAUAIEtQAACyBAUAIEtQAACyBAUAIEtQAACyBAUAIOt/AF/NOS2QamPWAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<IPython.core.display.Image object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "co = df.Count()\n",
    "m_a = df.Mean(\"a\")\n",
    "\n",
    "fil1 = df.Filter(\"c < 0.7\")\n",
    "def1 = fil1.Define(\"d\", \"a+b+c\")\n",
    "h = def1.Histo1D(\"d\")\n",
    "\n",
    "c = ROOT.TCanvas()\n",
    "h.Draw()\n",
    "\n",
    "print(f\"Number of rows in the dataset: {co.GetValue()}\")\n",
    "print(f\"Average value of column a: {m_a.GetValue()}\")\n",
    "c.Draw()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "493f8f3c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.43957785566580226"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Try it!\n",
    "# To-do: Get the mean value of column \"c\"\n",
    "\n",
    "\n",
    "# The printout should be 0.43957785566580226"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "47a18efa",
   "metadata": {
    "collapsed": true,
    "slideshow": {
     "slide_type": "subslide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'a': ndarray([0.88844238, 0.900535  , 0.96825323, 0.14714924, 0.65111047,\n",
       "          0.00768986, 0.33848759, 0.23674716, 0.89608948, 0.29994253,\n",
       "          0.2096464 , 0.64004154, 0.43697073, 0.29892036, 0.06817104,\n",
       "          0.05222412, 0.98122417, 0.98446942, 0.27117487, 0.13256602,\n",
       "          0.34084916, 0.23491009, 0.32068643, 0.72822042, 0.7710048 ,\n",
       "          0.8522306 , 0.85746265, 0.9200117 , 0.21378831, 0.77172578,\n",
       "          0.56352852, 0.96611382, 0.96412962, 0.37538235, 0.41918385,\n",
       "          0.80238554, 0.43830317, 0.15762997, 0.99523027, 0.484956  ,\n",
       "          0.90498863, 0.36807776, 0.13658789, 0.21365148, 0.00893957,\n",
       "          0.12407072, 0.07976361, 0.76622546, 0.46557753, 0.62036033,\n",
       "          0.41229638, 0.49840041, 0.4263415 , 0.61866683, 0.28776   ,\n",
       "          0.29497612, 0.35616968, 0.787211  , 0.38452214, 0.97618113,\n",
       "          0.80764095, 0.33833193, 0.6587734 , 0.78965527, 0.04997491,\n",
       "          0.59990502, 0.45309396, 0.83542956, 0.45840176, 0.99392861,\n",
       "          0.60004006, 0.86986565, 0.91787562, 0.61474074, 0.7811355 ,\n",
       "          0.31380488, 0.24182307]),\n",
       " 'b': ndarray([0.40702241, 0.74129923, 0.18107897, 0.09065073, 0.40322032,\n",
       "          0.97063978, 0.21297639, 0.42887613, 0.43430869, 0.20450665,\n",
       "          0.4827311 , 0.93090292, 0.45213087, 0.61341716, 0.94827759,\n",
       "          0.32355509, 0.52605221, 0.55971498, 0.14843606, 0.19361249,\n",
       "          0.76743236, 0.54955014, 0.1608052 , 0.35732976, 0.10466031,\n",
       "          0.36919999, 0.98070539, 0.16100484, 0.43800289, 0.67235598,\n",
       "          0.35587679, 0.52697685, 0.9707623 , 0.67721743, 0.22180804,\n",
       "          0.38284524, 0.73713499, 0.69246795, 0.9864423 , 0.49209006,\n",
       "          0.52224664, 0.18706242, 0.03163983, 0.22132215, 0.02014056,\n",
       "          0.26480848, 0.20888065, 0.01194962, 0.99694482, 0.13664396,\n",
       "          0.96677895, 0.9992432 , 0.44700017, 0.47300536, 0.35508057,\n",
       "          0.21134544, 0.36207256, 0.67414269, 0.56556399, 0.59445778,\n",
       "          0.81049597, 0.69884043, 0.24185121, 0.4260769 , 0.33305894,\n",
       "          0.29375287, 0.51446663, 0.44664262, 0.04449011, 0.37550639,\n",
       "          0.84642401, 0.29101479, 0.80835555, 0.81613266, 0.1983288 ,\n",
       "          0.44309051, 0.68206472]),\n",
       " 'c': ndarray([0.35895991, 0.41313578, 0.09144125, 0.55242407, 0.49622545,\n",
       "          0.10755882, 0.66708536, 0.60484859, 0.45592548, 0.03597389,\n",
       "          0.15037891, 0.64218227, 0.62531293, 0.4743205 , 0.54074605,\n",
       "          0.66245871, 0.19504631, 0.55872815, 0.62603898, 0.62278945,\n",
       "          0.47191909, 0.27665921, 0.08780504, 0.40654939, 0.02448357,\n",
       "          0.2445925 , 0.63726825, 0.1693742 , 0.38532064, 0.07505232,\n",
       "          0.22704283, 0.1076303 , 0.01053603, 0.07837568, 0.45967832,\n",
       "          0.65612722, 0.18710839, 0.28851356, 0.67912518, 0.31010392,\n",
       "          0.23792334, 0.44411362, 0.13242944, 0.66943208, 0.06716033,\n",
       "          0.31828849, 0.02585359, 0.31403326, 0.13483881, 0.58739558,\n",
       "          0.14621885, 0.31733806, 0.40617817, 0.28020789, 0.4454364 ,\n",
       "          0.64825316, 0.41845814, 0.3220973 , 0.10074278, 0.08453626,\n",
       "          0.2433915 , 0.11524202, 0.03907429, 0.64573901, 0.37400439,\n",
       "          0.51315129, 0.18486817, 0.39262204, 0.04734236, 0.38425521,\n",
       "          0.34725581, 0.02635418, 0.42556635, 0.27912792, 0.00782217,\n",
       "          0.57223289, 0.53282743]),\n",
       " 'd': ndarray([1.65442471, 2.05497002, 1.24077345, 0.79022404, 1.55055624,\n",
       "          1.08588846, 1.21854935, 1.27047188, 1.78632366, 0.54042307,\n",
       "          0.84275641, 2.21312672, 1.51441453, 1.38665801, 1.55719468,\n",
       "          1.03823793, 1.7023227 , 2.10291256, 1.04564991, 0.94896795,\n",
       "          1.5802006 , 1.06111945, 0.56929668, 1.49209957, 0.90014868,\n",
       "          1.46602309, 2.47543629, 1.25039074, 1.03711184, 1.51913408,\n",
       "          1.14644814, 1.60072098, 1.94542796, 1.13097546, 1.10067021,\n",
       "          1.841358  , 1.36254655, 1.13861147, 2.66079774, 1.28714999,\n",
       "          1.66515861, 0.9992538 , 0.30065716, 1.10440571, 0.09624046,\n",
       "          0.70716769, 0.31449785, 1.09220834, 1.59736116, 1.34439987,\n",
       "          1.52529419, 1.81498166, 1.27951983, 1.37188008, 1.08827698,\n",
       "          1.15457472, 1.13670038, 1.78345099, 1.05082891, 1.65517517,\n",
       "          1.86152842, 1.15241438, 0.9396989 , 1.86147118, 0.75703823,\n",
       "          1.40680918, 1.15242876, 1.67469422, 0.55023422, 1.75369021,\n",
       "          1.79371989, 1.18723463, 2.15179753, 1.71000132, 0.98728647,\n",
       "          1.32912828, 1.45671522])}"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Export the modified dataframe to a dictionary of numpy arrays\n",
    "\n",
    "np_dict_mod = def1.AsNumpy()\n",
    "\n",
    "np_dict_mod"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "591db200",
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'a': ndarray([0.89171103, 0.38538969, 0.62489645, 0.85250374, 0.271063  ,\n",
       "          0.04244154, 0.21981518, 0.00653207, 0.97577161, 0.70376849,\n",
       "          0.0855774 , 0.86017707, 0.94231746, 0.05599941, 0.07117043,\n",
       "          0.10774222, 0.34104324, 0.353957  , 0.53321741, 0.27640866,\n",
       "          0.65782067, 0.10603851, 0.90373479, 0.31969525, 0.61811717,\n",
       "          0.95470248, 0.86416954, 0.80392969, 0.32117697, 0.26929924,\n",
       "          0.08533137, 0.29992891, 0.17906622, 0.87616529, 0.70625461,\n",
       "          0.75393689, 0.1152033 , 0.92028508, 0.39672788, 0.43665752,\n",
       "          0.0140612 , 0.02428224, 0.0589956 , 0.13687369, 0.23926276,\n",
       "          0.59236442, 0.74901958, 0.9128569 , 0.26936721, 0.5146416 ,\n",
       "          0.01772699, 0.07026257, 0.72839134, 0.71351605, 0.87727638,\n",
       "          0.97041711, 0.22194914, 0.55887689, 0.95146264, 0.08724645,\n",
       "          0.48637192, 0.74417467, 0.53688302, 0.6725586 , 0.1941396 ,\n",
       "          0.97645349, 0.18868174, 0.80977102, 0.47304493, 0.59022976,\n",
       "          0.97999293, 0.68230194, 0.79129258, 0.77586358, 0.35684928,\n",
       "          0.896175  , 0.13125804]),\n",
       " 'b': ndarray([1.96208486e-01, 2.17796710e-01, 1.86359240e-01, 1.34852425e-01,\n",
       "          8.31525676e-01, 2.83652032e-01, 4.57474359e-02, 7.03055817e-01,\n",
       "          6.77181911e-01, 2.28491707e-01, 5.84849535e-01, 1.41737338e-01,\n",
       "          8.37577378e-01, 7.24001460e-01, 5.79920194e-02, 1.61872785e-01,\n",
       "          1.46068023e-01, 5.39283056e-01, 4.29941562e-01, 1.88703278e-01,\n",
       "          2.14264190e-01, 7.26839843e-02, 2.37729313e-01, 4.88299063e-01,\n",
       "          5.27492547e-02, 7.45285002e-01, 8.24919721e-01, 2.28716032e-02,\n",
       "          1.22885654e-01, 1.67646166e-01, 5.96773417e-01, 6.01120733e-01,\n",
       "          9.59032032e-01, 4.71649185e-01, 5.92491761e-01, 6.80711652e-01,\n",
       "          7.37147744e-01, 9.34308117e-01, 8.93421904e-01, 9.89623789e-02,\n",
       "          6.03019444e-01, 1.51082170e-01, 2.44847760e-01, 8.29147823e-01,\n",
       "          1.33634447e-01, 5.69380832e-01, 2.50170145e-01, 9.40416065e-01,\n",
       "          8.43664513e-01, 3.09087437e-01, 7.83493506e-01, 5.94645957e-01,\n",
       "          5.87566622e-01, 8.74885571e-01, 3.66329107e-01, 9.06941581e-01,\n",
       "          9.35144373e-01, 4.45820353e-03, 2.89127626e-04, 1.45357697e-01,\n",
       "          8.96048676e-01, 1.21591011e-01, 7.10379841e-01, 7.42831445e-01,\n",
       "          9.50914782e-01, 5.56416399e-01, 4.10325720e-01, 2.54906835e-01,\n",
       "          6.55666338e-01, 7.50934819e-01, 7.87296667e-01, 1.83843724e-01,\n",
       "          1.47592621e-01, 4.34726228e-01, 4.50220119e-01, 2.09755603e-01,\n",
       "          4.60060310e-01])}"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Try it!\n",
    "# To-do: Turn the dataframe to a dicitonary of numpy arrays with only \"a\" and \"b\" columns\n",
    "def1.AsNumpy([\"\", \"\"])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b3fbd633",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "## Multiple concurrent RDataFrame runs\n",
    "If your analysis needs multiple RDataFrames to run (for example multiple dataset samples, data vs simulation etc.), make use of `ROOT.RDF.RunGraphs` "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "f342906a",
   "metadata": {
    "slideshow": {
     "slide_type": "subslide"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning in <RTaskArenaWrapper>: CPU Bandwith Control Active. Proceeding with 2 threads accordingly\n"
     ]
    }
   ],
   "source": [
    "ROOT.EnableImplicitMT()\n",
    "treename1 = \"myDataset\"\n",
    "filename1 = \"data/collections_dataset.root\"\n",
    "treename2 = \"dataset\"\n",
    "filename2 = \"data/example_file.root\"\n",
    "\n",
    "df1 = ROOT.RDataFrame(treename1, filename1)\n",
    "df2 = ROOT.RDataFrame(treename2, filename2)\n",
    "h1 = df1.Histo1D(\"px\")\n",
    "h2 = df2.Histo1D(\"a\")\n",
    " \n",
    "\n",
    "ROOT.RDF.RunGraphs((h1, h2))\n",
    "ROOT.DisableImplicitMT()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "1b715694",
   "metadata": {
    "slideshow": {
     "slide_type": "subslide"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<IPython.core.display.Image object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "c = ROOT.TCanvas()\n",
    "h1.Draw()\n",
    "c.Draw()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "795a5420",
   "metadata": {
    "slideshow": {
     "slide_type": "subslide"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<IPython.core.display.Image object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "c = ROOT.TCanvas()\n",
    "h2.Draw()\n",
    "c.Draw()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "799b981e",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "# Re-defining values of a column\n",
    "\n",
    "Sometimes you might want to keep a column with the same name, but modify its values. This is available via the `Redefine` method."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "374e35a3",
   "metadata": {
    "slideshow": {
     "slide_type": "subslide"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-----+----+\n",
      "| Row | x  | \n",
      "+-----+----+\n",
      "| 0   | 42 | \n",
      "+-----+----+\n",
      "| 1   | 42 | \n",
      "+-----+----+\n",
      "| 2   | 42 | \n",
      "+-----+----+\n",
      "| 3   | 42 | \n",
      "+-----+----+\n",
      "| 4   | 42 | \n",
      "+-----+----+\n"
     ]
    }
   ],
   "source": [
    "df = ROOT.RDataFrame(5).Define(\"x\", \"42\")\n",
    "df.Display().Print()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a7a7a553",
   "metadata": {
    "slideshow": {
     "slide_type": "subslide"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-----+-----+\n",
      "| Row | x   | \n",
      "+-----+-----+\n",
      "| 0   | 420 | \n",
      "+-----+-----+\n",
      "| 1   | 420 | \n",
      "+-----+-----+\n",
      "| 2   | 420 | \n",
      "+-----+-----+\n",
      "| 3   | 420 | \n",
      "+-----+-----+\n",
      "| 4   | 420 | \n",
      "+-----+-----+\n"
     ]
    }
   ],
   "source": [
    "df = df.Redefine(\"x\", \"x * 10\")\n",
    "df.Display().Print()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "e2e09b74",
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-----+-------+\n",
      "| Row | x     | \n",
      "+-----+-------+\n",
      "| 0   | 42000 | \n",
      "+-----+-------+\n",
      "| 1   | 42000 | \n",
      "+-----+-------+\n",
      "| 2   | 42000 | \n",
      "+-----+-------+\n",
      "| 3   | 42000 | \n",
      "+-----+-------+\n",
      "| 4   | 42000 | \n",
      "+-----+-------+\n"
     ]
    }
   ],
   "source": [
    "# Try it!\n",
    "# To-do: Redifine the x column again with x * 100\n",
    "\n",
    "\n",
    "df.Display().Print()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d820208f",
   "metadata": {
    "slideshow": {
     "slide_type": "subslide"
    }
   },
   "source": [
    "Notice how we could use the previous values of the `\"x\"` column to define the new values."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cc296f7d",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "# Distributed RDataFrame\n",
    "\n",
    "An `RDataFrame` analysis written in Python can be executed both *locally* - possibly in parallel on the cores of the machine - and *distributedly* by offloading computations to external resources, which include:\n",
    "\n",
    "- [Spark](https://spark.apache.org/) and \n",
    "- [Dask](https://dask.org/) clusters. \n",
    "\n",
    "- This feature is enabled by the architecture depicted below.\n",
    "\n",
    "- It shows that RDataFrame computation graphs can be mapped to different kinds of resources via backends.\n",
    "\n",
    "- In this notebook we will exercise the Dask backend, which divides an `RDataFrame` input dataset in logical ranges and submits computations for each of those ranges to Dask resources.\n",
    "\n",
    "<img src=\"images/DistRDF_architecture.png\" alt=\"Distributed RDataFrame\">"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c2731e8a",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "## Create a Dask client\n",
    "\n",
    "- In order to work with a Dask cluster we need a `Client` object.\n",
    "- It represents the connection to that cluster and allows to configure execution-related parameters (e.g. number of cores, memory). \n",
    "- The client object is just the intermediary between our client session and the cluster resources, \n",
    "- Dask supports many different resource managers.\n",
    "- We will follow the [Dask documentation](https://distributed.dask.org/en/stable/client.html) regarding the creation of a `Client`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "a4e156e5",
   "metadata": {
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [],
   "source": [
    "from dask.distributed import Client, LocalCluster\n",
    "cluster = LocalCluster(n_workers=2, threads_per_worker=1, processes=True, memory_limit=\"2GiB\")\n",
    "client = Client(cluster)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "601ffed1",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "## Create a ROOT dataframe\n",
    "\n",
    "We now create an RDataFrame based on the same dataset seen in the exercise [rdataframe-dimuon](exercises/rdataframe-dimuon.ipynb).\n",
    "\n",
    "A Dask `RDataFrame` receives two extra parameters: \n",
    "- the number of partitions to apply to the dataset (`npartitions`)\n",
    "- the `Client` object (`daskclient`). \n",
    "\n",
    "Besides this detail, a Dask `RDataFrame` is not different from a local `RDataFrame`: the analysis presented in this notebook would not change if we wanted to execute it locally."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "405cf12f",
   "metadata": {
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [],
   "source": [
    "# Use a Dask RDataFrame\n",
    "RDataFrame = ROOT.RDF.Experimental.Distributed.Dask.RDataFrame\n",
    "\n",
    "df = RDataFrame(\"h42\",\n",
    "                \"https://root.cern/files/h1big.root\",\n",
    "                npartitions=4,\n",
    "                daskclient=client)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "563a28e4",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "## Run your analysis unchanged\n",
    "\n",
    "- From now on, the rest of your application can be written **exactly** as we have seen with local RDataFrame. \n",
    "\n",
    "- The goal of the distributed RDataFrame module is to support all the traditional RDataFrame operations (those that make sense in a distributed context at least). \n",
    "\n",
    "- Currently only a subset of those is available and can be found in the corresponding [section of the documentation](https://root.cern/doc/master/classROOT_1_1RDataFrame.html#distrdf)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "43562f8d",
   "metadata": {
    "slideshow": {
     "slide_type": "subslide"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of events after processing: 283813\n",
      "Mean of column 'mpt': 0.13190819625023323\n",
      "CPU times: user 474 ms, sys: 65.7 ms, total: 540 ms\n",
      "Wall time: 12.7 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "df1 = df.Filter(\"nevent > 1\")\n",
    "df2 = df1.Define(\"mpt\",\"sqrt(xpt*xpt + ypt*ypt)\")\n",
    "c = df.Count()\n",
    "m = df2.Mean(\"mpt\")\n",
    "print(f\"Number of events after processing: {c.GetValue()}\")\n",
    "print(f\"Mean of column 'mpt': {m.GetValue()}\")"
   ]
  }
 ],
 "metadata": {
  "celltoolbar": "Slideshow",
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
